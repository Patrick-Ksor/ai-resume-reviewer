import{d as M,o as j,J as N,s as q,e as n,T as z,w as m,c as P,l as B,b as t,y as C,g as $,n as L,P as F,a as x,i as c,t as I,_ as J,Q as R,m as b,h,R as S}from"./index-Dgz2JEFO.js";import{B as v}from"./BaseInput-BIifltlw.js";import{_ as y}from"./BaseButton.vue_vue_type_script_setup_true_lang-CRAMmwsf.js";import{u as Y}from"./useAuth-1EP6KlsI.js";import{u as K}from"./useToast-C5s0dywv.js";const O={key:0,class:"flex items-center justify-between mb-5"},Q={class:"text-lg font-semibold text-white"},Z={key:1,class:"mt-6 flex justify-end gap-3"},G=M({__name:"BaseModal",props:{open:{type:Boolean},title:{},size:{default:"md"}},emits:["update:open"],setup(f,{emit:w}){const k=f,d=w,o={sm:"max-w-sm",md:"max-w-lg",lg:"max-w-2xl"};function i(){d("update:open",!1)}function l(s){s.key==="Escape"&&k.open&&i()}return j(()=>document.addEventListener("keydown",l)),N(()=>document.removeEventListener("keydown",l)),(s,p)=>(x(),q(F,{to:"#modals"},[n(z,{name:"modal"},{default:m(()=>[f.open?(x(),P("div",{key:0,class:"fixed inset-0 z-[9998] flex items-center justify-center p-4",onClick:B(i,["self"])},[t("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:i}),t("div",{class:L(["relative w-full glass-card rounded-2xl p-6 shadow-glass-lg",o[f.size]])},[f.title||s.$slots.header?(x(),P("div",O,[t("h3",Q,[C(s.$slots,"header",{},()=>[c(I(f.title),1)],!0)]),t("button",{type:"button",class:"flex h-8 w-8 items-center justify-center rounded-lg text-white/40 hover:text-white hover:bg-white/10 transition-colors",onClick:i},[...p[0]||(p[0]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])):$("",!0),C(s.$slots,"default",{},void 0,!0),s.$slots.footer?(x(),P("div",Z,[C(s.$slots,"footer",{},void 0,!0)])):$("",!0)],2)])):$("",!0)]),_:3})]))}}),H=J(G,[["__scopeId","data-v-9f469fa5"]]),W={class:"p-6 sm:p-8 max-w-2xl mx-auto space-y-6"},X={class:"glass-card rounded-2xl p-6 space-y-5"},_={class:"flex justify-end"},ee={class:"glass-card rounded-2xl p-6 space-y-5"},te={class:"flex justify-end"},se={class:"rounded-2xl border border-red-500/20 bg-red-500/5 p-6 space-y-4"},ae={class:"flex items-center justify-between gap-4 flex-wrap"},ie=M({__name:"SettingsView",setup(f){const w=R(),{logout:k}=Y(),d=K(),o=b({name:"",email:""}),i=h(!1),l=b({name:"",email:""}),s=b({current:"",newPwd:"",confirm:""}),p=h(!1),r=b({current:"",newPwd:"",confirm:""}),g=h(!1),V=h(!1);j(()=>{o.name=w.user?.name??"",o.email=w.user?.email??""});function A(){return l.name=o.name.trim().length<2?"Name must be at least 2 characters.":"",l.email=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email)?"":"Enter a valid email.",!l.name&&!l.email}async function E(){if(A()){i.value=!0;try{const u=await S.updateProfile({name:o.name,email:o.email});w.user=u,d.success("Profile updated!")}catch(u){d.error(u.message??"Failed to update profile.")}finally{i.value=!1}}}function T(){return r.current=s.current?"":"Current password is required.",r.newPwd=s.newPwd.length<8?"New password must be at least 8 characters.":"",r.confirm=s.newPwd!==s.confirm?"Passwords do not match.":"",!r.current&&!r.newPwd&&!r.confirm}async function U(){if(T()){p.value=!0;try{await S.changePassword({currentPassword:s.current,newPassword:s.newPwd}),d.success("Password changed successfully!"),s.current=s.newPwd=s.confirm=""}catch(u){d.error(u.message??"Failed to change password.")}finally{p.value=!1}}}async function D(){V.value=!0;try{await S.deleteAccount(),d.info("Your account has been deleted."),await k()}catch(u){d.error(u.message??"Deletion failed."),V.value=!1}}return(u,e)=>(x(),P("div",W,[e[18]||(e[18]=t("div",null,[t("h1",{class:"text-2xl font-black text-white"},"Account Settings"),t("p",{class:"text-sm text-white/40 mt-1"},"Manage your profile and account preferences.")],-1)),t("div",X,[e[9]||(e[9]=t("h2",{class:"text-base font-semibold text-white"},"Profile Information",-1)),t("form",{class:"space-y-4",onSubmit:B(E,["prevent"])},[n(v,{modelValue:o.name,"onUpdate:modelValue":e[0]||(e[0]=a=>o.name=a),label:"Full name",placeholder:"Jane Smith",error:l.name,required:""},null,8,["modelValue","error"]),n(v,{modelValue:o.email,"onUpdate:modelValue":e[1]||(e[1]=a=>o.email=a),label:"Email address",type:"email",placeholder:"you@example.com",error:l.email,required:""},null,8,["modelValue","error"]),t("div",_,[n(y,{type:"submit",variant:"primary",loading:i.value},{default:m(()=>[...e[8]||(e[8]=[c("Save Changes",-1)])]),_:1},8,["loading"])])],32)]),t("div",ee,[e[11]||(e[11]=t("h2",{class:"text-base font-semibold text-white"},"Change Password",-1)),t("form",{class:"space-y-4",onSubmit:B(U,["prevent"])},[n(v,{modelValue:s.current,"onUpdate:modelValue":e[2]||(e[2]=a=>s.current=a),label:"Current password",type:"password",placeholder:"••••••••",error:r.current,required:""},null,8,["modelValue","error"]),n(v,{modelValue:s.newPwd,"onUpdate:modelValue":e[3]||(e[3]=a=>s.newPwd=a),label:"New password",type:"password",placeholder:"Min. 8 characters",error:r.newPwd,required:""},null,8,["modelValue","error"]),n(v,{modelValue:s.confirm,"onUpdate:modelValue":e[4]||(e[4]=a=>s.confirm=a),label:"Confirm new password",type:"password",placeholder:"Repeat new password",error:r.confirm,required:""},null,8,["modelValue","error"]),t("div",te,[n(y,{type:"submit",variant:"primary",loading:p.value},{default:m(()=>[...e[10]||(e[10]=[c("Update Password",-1)])]),_:1},8,["loading"])])],32)]),t("div",se,[e[14]||(e[14]=t("h2",{class:"text-base font-semibold text-red-400"},"Danger Zone",-1)),t("div",ae,[e[13]||(e[13]=t("div",null,[t("p",{class:"text-sm font-medium text-white"},"Delete Account"),t("p",{class:"text-xs text-white/40 mt-0.5"},"Permanently delete your account and all your data. This cannot be undone.")],-1)),n(y,{variant:"danger",onClick:e[5]||(e[5]=a=>g.value=!0)},{default:m(()=>[...e[12]||(e[12]=[c("Delete Account",-1)])]),_:1})])]),n(H,{open:g.value,"onUpdate:open":e[7]||(e[7]=a=>g.value=a),title:"Delete Account",size:"sm"},{footer:m(()=>[n(y,{variant:"ghost",onClick:e[6]||(e[6]=a=>g.value=!1)},{default:m(()=>[...e[15]||(e[15]=[c("Cancel",-1)])]),_:1}),n(y,{variant:"danger",loading:V.value,onClick:D},{default:m(()=>[...e[16]||(e[16]=[c(" Yes, delete my account ",-1)])]),_:1},8,["loading"])]),default:m(()=>[e[17]||(e[17]=t("p",{class:"text-sm text-white/70 leading-relaxed"},[c(" Are you absolutely sure? This will permanently delete your account, all your analyses, and all associated data. "),t("span",{class:"text-red-400 font-semibold"},"This action cannot be undone.")],-1))]),_:1},8,["open"])]))}});export{ie as default};
//# sourceMappingURL=SettingsView-VkrWymaN.js.map
