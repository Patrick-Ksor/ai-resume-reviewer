{"version":3,"file":"HistoryView-D7QV-Wh_.js","sources":["../../src/views/private/HistoryView.vue"],"sourcesContent":["<script setup lang=\"ts\">\r\nimport { ref, onMounted, watch } from 'vue'\r\nimport { useDebounceFn } from '@vueuse/core'\r\nimport BaseSkeleton from '@/components/ui/BaseSkeleton.vue'\r\nimport BaseInput from '@/components/ui/BaseInput.vue'\r\nimport FilterPill from '@/components/ui/FilterPill.vue'\r\nimport { useAnalysisStore } from '@/stores/analysis'\r\nimport type { AnalysisStatus } from '@/types/analysis'\r\n\r\nconst store = useAnalysisStore()\r\n\r\nconst search = ref('')\r\nconst statusFilter = ref<AnalysisStatus | 'all'>('all')\r\nconst page = ref(1)\r\n\r\nconst statuses = ['all', 'completed', 'processing', 'failed'] as const\r\n\r\nasync function load() {\r\n  await store.fetchHistory({\r\n    page: page.value,\r\n    limit: 10,\r\n    search: search.value || undefined,\r\n    status: statusFilter.value === 'all' ? undefined : statusFilter.value,\r\n  })\r\n}\r\n\r\nonMounted(load)\r\n\r\nconst debouncedSearch = useDebounceFn(async () => {\r\n  page.value = 1\r\n  await load()\r\n}, 400)\r\n\r\nwatch(search, debouncedSearch)\r\nwatch(statusFilter, async () => { page.value = 1; await load() })\r\n\r\nfunction formatDate(d: string) {\r\n  return new Date(d).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })\r\n}\r\n\r\nconst statusColors: Record<string, string> = {\r\n  completed:  'text-green-400 bg-green-400/10',\r\n  processing: 'text-yellow-400 bg-yellow-400/10',\r\n  pending:    'text-white/40 bg-white/5',\r\n  failed:     'text-red-400 bg-red-400/10',\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"p-6 sm:p-8 max-w-5xl mx-auto space-y-6\">\r\n    <!-- Header -->\r\n    <div>\r\n      <h1 class=\"text-2xl font-black text-white\">Analysis History</h1>\r\n      <p class=\"text-sm text-white/40 mt-1\">Browse and review all your past resume analyses.</p>\r\n    </div>\r\n\r\n    <!-- Search + filters row -->\r\n    <div class=\"flex flex-col sm:flex-row gap-3\">\r\n      <div class=\"flex-1\">\r\n        <BaseInput\r\n          v-model=\"search\"\r\n          placeholder=\"Search by filename…\"\r\n          type=\"search\"\r\n        >\r\n          <template #prefix>\r\n            <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"/>\r\n            </svg>\r\n          </template>\r\n        </BaseInput>\r\n      </div>\r\n\r\n      <div class=\"flex items-center gap-2 overflow-x-auto pb-1\">\r\n        <FilterPill\r\n          v-for=\"s in statuses\"\r\n          :key=\"s\"\r\n          :label=\"s === 'all' ? 'All' : s.charAt(0).toUpperCase() + s.slice(1)\"\r\n          :active=\"statusFilter === s\"\r\n          @click=\"statusFilter = s\"\r\n        />\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Table -->\r\n    <div class=\"glass-card rounded-2xl overflow-hidden\">\r\n      <!-- Loading -->\r\n      <div v-if=\"store.loadingHistory\" class=\"divide-y divide-white/[0.04]\">\r\n        <div v-for=\"n in 5\" :key=\"n\" class=\"px-6 py-4 flex items-center gap-4\">\r\n          <BaseSkeleton width=\"2.5rem\" height=\"2.5rem\" rounded=\"rounded-xl\" />\r\n          <div class=\"flex-1 space-y-2\">\r\n            <BaseSkeleton width=\"50%\" height=\"0.875rem\" />\r\n            <BaseSkeleton width=\"30%\" height=\"0.75rem\" />\r\n          </div>\r\n          <BaseSkeleton width=\"4rem\" height=\"1.5rem\" rounded=\"rounded-full\" />\r\n          <BaseSkeleton width=\"2rem\" height=\"1rem\" rounded=\"rounded\" />\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Empty -->\r\n      <div v-else-if=\"!store.history.length\" class=\"px-6 py-16 text-center\">\r\n        <svg class=\"w-12 h-12 text-white/10 mx-auto mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1.2\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"/>\r\n        </svg>\r\n        <p class=\"text-white/30 text-sm\">{{ search ? 'No results found.' : 'No analyses yet.' }}</p>\r\n      </div>\r\n\r\n      <!-- Rows -->\r\n      <div v-else class=\"divide-y divide-white/[0.04]\">\r\n        <RouterLink\r\n          v-for=\"a in store.history\"\r\n          :key=\"a.id\"\r\n          :to=\"{ name: 'analysis-results', params: { id: a.id } }\"\r\n          class=\"px-6 py-4 flex items-center gap-4 hover:bg-white/[0.02] transition-all duration-200 group\"\r\n        >\r\n          <!-- ATS score bubble -->\r\n          <div\r\n            :class=\"[\r\n              'flex h-11 w-11 shrink-0 items-center justify-center rounded-xl text-sm font-bold transition-transform duration-200 group-hover:-translate-y-0.5',\r\n              (a.atsScore?.overall ?? 0) >= 80 ? 'bg-green-400/10 text-green-300' :\r\n              (a.atsScore?.overall ?? 0) >= 50 ? 'bg-yellow-400/10 text-yellow-300' :\r\n              a.atsScore ? 'bg-red-400/10 text-red-300' : 'bg-surface-600 text-white/30',\r\n            ]\"\r\n          >\r\n            {{ a.atsScore?.overall ?? '—' }}\r\n          </div>\r\n\r\n          <div class=\"flex-1 min-w-0\">\r\n            <p class=\"text-sm font-medium text-white truncate group-hover:text-brand-300 transition-colors\">\r\n              {{ a.resumeFilename ?? 'Untitled Analysis' }}\r\n            </p>\r\n            <p class=\"text-xs text-white/40 mt-0.5\">{{ formatDate(a.createdAt) }}</p>\r\n          </div>\r\n\r\n          <span :class=\"['text-xs px-2.5 py-1 rounded-full font-medium capitalize', statusColors[a.status] ?? '']\">\r\n            {{ a.status }}\r\n          </span>\r\n\r\n          <svg class=\"w-4 h-4 text-white/20 group-hover:text-brand-400 transition-colors shrink-0\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 5l7 7-7 7\"/>\r\n          </svg>\r\n        </RouterLink>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Pagination -->\r\n    <div v-if=\"store.historyTotalPages > 1\" class=\"flex justify-center items-center gap-3\">\r\n      <button\r\n        type=\"button\"\r\n        :disabled=\"page <= 1\"\r\n        class=\"h-9 w-9 flex items-center justify-center rounded-lg border border-white/10 text-white/50 hover:text-white hover:border-white/20 disabled:opacity-30 disabled:cursor-not-allowed transition-all\"\r\n        @click=\"page--; load()\"\r\n      >\r\n        <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 19l-7-7 7-7\"/>\r\n        </svg>\r\n      </button>\r\n      <span class=\"text-sm text-white/50\">{{ page }} / {{ store.historyTotalPages }}</span>\r\n      <button\r\n        type=\"button\"\r\n        :disabled=\"page >= store.historyTotalPages\"\r\n        class=\"h-9 w-9 flex items-center justify-center rounded-lg border border-white/10 text-white/50 hover:text-white hover:border-white/20 disabled:opacity-30 disabled:cursor-not-allowed transition-all\"\r\n        @click=\"page++; load()\"\r\n      >\r\n        <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 5l7 7-7 7\"/>\r\n        </svg>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</template>\r\n"],"names":["store","useAnalysisStore","search","ref","statusFilter","page","statuses","load","onMounted","debouncedSearch","useDebounceFn","watch","formatDate","d","statusColors","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","BaseInput","$event","_cache","_hoisted_4","_Fragment","_renderList","s","FilterPill","_hoisted_5","_unref","_hoisted_6","n","BaseSkeleton","_hoisted_7","_hoisted_10","a","_createBlock","_component_RouterLink","_normalizeClass","_hoisted_11","_hoisted_12","_toDisplayString","_hoisted_13","_hoisted_8","_hoisted_9","_hoisted_14","_hoisted_16"],"mappings":"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"}