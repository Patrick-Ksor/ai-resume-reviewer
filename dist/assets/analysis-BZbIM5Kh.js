import{N as p,O as H,h as s,x as h}from"./index-Dgz2JEFO.js";const g={async submitAnalysis(a,t,r,v){const u=new FormData;u.append("resume",a),u.append("portfolioUrl",t),u.append("jobDescription",r);const{data:i}=await p.post("/analyses",u,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:l=>{if(l.total){const y=Math.round(l.loaded*100/l.total);v?.(y)}}});return i.data},async getAnalysis(a){const{data:t}=await p.get(`/analyses/${a}`);return t.data},async getHistory(a){const t=new URLSearchParams;a?.page&&t.set("page",String(a.page)),a?.limit&&t.set("limit",String(a.limit)),a?.search&&t.set("search",a.search),a?.status&&t.set("status",a.status);const{data:r}=await p.get("/analyses",{params:t});return r},async downloadReport(a){const{data:t}=await p.get(`/analyses/${a}/download`,{responseType:"blob"});return t},async deleteAnalysis(a){await p.delete(`/analyses/${a}`)}},j=H("analysis",()=>{const a=s(null),t=s([]),r=s(0),v=s(1),u=s(1),i=s(!1),l=s(0),y=s(!1),m=s(!1),n=s(null),w=h(()=>!!a.value&&a.value.status==="completed"),b=h(()=>a.value?.atsScore?.overall??t.value[0]?.atsScore?.overall??null),A=h(()=>r.value);async function S(c,e,f){i.value=!0,l.value=0,n.value=null;try{const o=await g.submitAnalysis(c,e,f,d=>{l.value=d});return a.value=o,o}catch(o){throw n.value=o.message??"Submission failed",o}finally{i.value=!1}}async function R(c){y.value=!0,n.value=null;try{a.value=await g.getAnalysis(c)}catch(e){throw n.value=e.message??"Failed to load analysis",e}finally{y.value=!1}}async function U(c){m.value=!0,n.value=null;try{const e=await g.getHistory(c);t.value=e.data,r.value=e.total,v.value=e.page,u.value=e.totalPages}catch(e){n.value=e.message??"Failed to load history"}finally{m.value=!1}}async function P(c,e="resume-report.pdf"){const f=await g.downloadReport(c),o=URL.createObjectURL(f),d=document.createElement("a");d.href=o,d.download=e,d.click(),URL.revokeObjectURL(o)}function L(){a.value=null,l.value=0,n.value=null}return{current:a,history:t,historyTotal:r,historyPage:v,historyTotalPages:u,uploading:i,uploadProgress:l,loadingCurrent:y,loadingHistory:m,error:n,hasResults:w,latestAtsScore:b,totalAnalyses:A,submitAnalysis:S,fetchAnalysis:R,fetchHistory:U,downloadReport:P,clearCurrent:L}});export{j as u};
//# sourceMappingURL=analysis-BZbIM5Kh.js.map
