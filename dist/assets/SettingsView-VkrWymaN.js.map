{"version":3,"file":"SettingsView-VkrWymaN.js","sources":["../../src/components/ui/BaseModal.vue","../../src/views/private/SettingsView.vue"],"sourcesContent":["<script setup lang=\"ts\">\r\nimport { onMounted, onUnmounted } from 'vue'\r\n\r\ninterface Props {\r\n  open: boolean\r\n  title?: string\r\n  size?: 'sm' | 'md' | 'lg'\r\n}\r\n\r\nconst props = withDefaults(defineProps<Props>(), {\r\n  size: 'md',\r\n})\r\n\r\nconst emit = defineEmits<{ 'update:open': [value: boolean] }>()\r\n\r\nconst sizes = {\r\n  sm: 'max-w-sm',\r\n  md: 'max-w-lg',\r\n  lg: 'max-w-2xl',\r\n}\r\n\r\nfunction close() {\r\n  emit('update:open', false)\r\n}\r\n\r\nfunction onKeydown(e: KeyboardEvent) {\r\n  if (e.key === 'Escape' && props.open) close()\r\n}\r\n\r\nonMounted(() => document.addEventListener('keydown', onKeydown))\r\nonUnmounted(() => document.removeEventListener('keydown', onKeydown))\r\n</script>\r\n\r\n<template>\r\n  <Teleport to=\"#modals\">\r\n    <Transition name=\"modal\">\r\n      <div\r\n        v-if=\"open\"\r\n        class=\"fixed inset-0 z-[9998] flex items-center justify-center p-4\"\r\n        @click.self=\"close\"\r\n      >\r\n        <!-- Backdrop -->\r\n        <div class=\"absolute inset-0 bg-black/60 backdrop-blur-sm\" @click=\"close\" />\r\n\r\n        <!-- Panel -->\r\n        <div\r\n          :class=\"[\r\n            'relative w-full glass-card rounded-2xl p-6 shadow-glass-lg',\r\n            sizes[size],\r\n          ]\"\r\n        >\r\n          <!-- Header -->\r\n          <div v-if=\"title || $slots.header\" class=\"flex items-center justify-between mb-5\">\r\n            <h3 class=\"text-lg font-semibold text-white\">\r\n              <slot name=\"header\">{{ title }}</slot>\r\n            </h3>\r\n            <button\r\n              type=\"button\"\r\n              class=\"flex h-8 w-8 items-center justify-center rounded-lg text-white/40 hover:text-white hover:bg-white/10 transition-colors\"\r\n              @click=\"close\"\r\n            >\r\n              <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\"/>\r\n              </svg>\r\n            </button>\r\n          </div>\r\n\r\n          <!-- Body -->\r\n          <slot />\r\n\r\n          <!-- Footer -->\r\n          <div v-if=\"$slots.footer\" class=\"mt-6 flex justify-end gap-3\">\r\n            <slot name=\"footer\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Transition>\r\n  </Teleport>\r\n</template>\r\n\r\n<style scoped>\r\n.modal-enter-active { transition: all 0.25s cubic-bezier(0.34, 1.56, 0.64, 1); }\r\n.modal-leave-active { transition: all 0.2s ease-in; }\r\n.modal-enter-from  { opacity: 0; transform: scale(0.92) translateY(8px); }\r\n.modal-leave-to    { opacity: 0; transform: scale(0.95) translateY(8px); }\r\n</style>\r\n","<script setup lang=\"ts\">\r\nimport { reactive, ref, onMounted } from 'vue'\r\nimport BaseInput from '@/components/ui/BaseInput.vue'\r\nimport BaseButton from '@/components/ui/BaseButton.vue'\r\nimport BaseModal from '@/components/ui/BaseModal.vue'\r\nimport { authService } from '@/services/authService'\r\nimport { useAuthStore } from '@/stores/auth'\r\nimport { useAuth } from '@/composables/useAuth'\r\nimport { useToast } from '@/composables/useToast'\r\n\r\nconst authStore = useAuthStore()\r\nconst { logout } = useAuth()\r\nconst toast = useToast()\r\n\r\nconst profile = reactive({ name: '', email: '' })\r\nconst profileLoading = ref(false)\r\nconst profileErrors = reactive({ name: '', email: '' })\r\n\r\nconst pwd = reactive({ current: '', newPwd: '', confirm: '' })\r\nconst pwdLoading = ref(false)\r\nconst pwdErrors = reactive({ current: '', newPwd: '', confirm: '' })\r\n\r\nconst deleteModalOpen = ref(false)\r\nconst deleteLoading = ref(false)\r\n\r\nonMounted(() => {\r\n  profile.name  = authStore.user?.name  ?? ''\r\n  profile.email = authStore.user?.email ?? ''\r\n})\r\n\r\nfunction validateProfile() {\r\n  profileErrors.name  = profile.name.trim().length < 2 ? 'Name must be at least 2 characters.' : ''\r\n  profileErrors.email = !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(profile.email) ? 'Enter a valid email.' : ''\r\n  return !profileErrors.name && !profileErrors.email\r\n}\r\n\r\nasync function saveProfile() {\r\n  if (!validateProfile()) return\r\n  profileLoading.value = true\r\n  try {\r\n    const updated = await authService.updateProfile({ name: profile.name, email: profile.email })\r\n    authStore.user = updated\r\n    toast.success('Profile updated!')\r\n  } catch (e) {\r\n    toast.error((e as { message?: string }).message ?? 'Failed to update profile.')\r\n  } finally {\r\n    profileLoading.value = false\r\n  }\r\n}\r\n\r\nfunction validatePwd() {\r\n  pwdErrors.current = !pwd.current ? 'Current password is required.' : ''\r\n  pwdErrors.newPwd  = pwd.newPwd.length < 8 ? 'New password must be at least 8 characters.' : ''\r\n  pwdErrors.confirm = pwd.newPwd !== pwd.confirm ? 'Passwords do not match.' : ''\r\n  return !pwdErrors.current && !pwdErrors.newPwd && !pwdErrors.confirm\r\n}\r\n\r\nasync function changePassword() {\r\n  if (!validatePwd()) return\r\n  pwdLoading.value = true\r\n  try {\r\n    await authService.changePassword({ currentPassword: pwd.current, newPassword: pwd.newPwd })\r\n    toast.success('Password changed successfully!')\r\n    pwd.current = pwd.newPwd = pwd.confirm = ''\r\n  } catch (e) {\r\n    toast.error((e as { message?: string }).message ?? 'Failed to change password.')\r\n  } finally {\r\n    pwdLoading.value = false\r\n  }\r\n}\r\n\r\nasync function confirmDelete() {\r\n  deleteLoading.value = true\r\n  try {\r\n    await authService.deleteAccount()\r\n    toast.info('Your account has been deleted.')\r\n    await logout()\r\n  } catch (e) {\r\n    toast.error((e as { message?: string }).message ?? 'Deletion failed.')\r\n    deleteLoading.value = false\r\n  }\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"p-6 sm:p-8 max-w-2xl mx-auto space-y-6\">\r\n    <!-- Header -->\r\n    <div>\r\n      <h1 class=\"text-2xl font-black text-white\">Account Settings</h1>\r\n      <p class=\"text-sm text-white/40 mt-1\">Manage your profile and account preferences.</p>\r\n    </div>\r\n\r\n    <!-- Profile section -->\r\n    <div class=\"glass-card rounded-2xl p-6 space-y-5\">\r\n      <h2 class=\"text-base font-semibold text-white\">Profile Information</h2>\r\n      <form class=\"space-y-4\" @submit.prevent=\"saveProfile\">\r\n        <BaseInput\r\n          v-model=\"profile.name\"\r\n          label=\"Full name\"\r\n          placeholder=\"Jane Smith\"\r\n          :error=\"profileErrors.name\"\r\n          required\r\n        />\r\n        <BaseInput\r\n          v-model=\"profile.email\"\r\n          label=\"Email address\"\r\n          type=\"email\"\r\n          placeholder=\"you@example.com\"\r\n          :error=\"profileErrors.email\"\r\n          required\r\n        />\r\n        <div class=\"flex justify-end\">\r\n          <BaseButton type=\"submit\" variant=\"primary\" :loading=\"profileLoading\">Save Changes</BaseButton>\r\n        </div>\r\n      </form>\r\n    </div>\r\n\r\n    <!-- Password section -->\r\n    <div class=\"glass-card rounded-2xl p-6 space-y-5\">\r\n      <h2 class=\"text-base font-semibold text-white\">Change Password</h2>\r\n      <form class=\"space-y-4\" @submit.prevent=\"changePassword\">\r\n        <BaseInput\r\n          v-model=\"pwd.current\"\r\n          label=\"Current password\"\r\n          type=\"password\"\r\n          placeholder=\"••••••••\"\r\n          :error=\"pwdErrors.current\"\r\n          required\r\n        />\r\n        <BaseInput\r\n          v-model=\"pwd.newPwd\"\r\n          label=\"New password\"\r\n          type=\"password\"\r\n          placeholder=\"Min. 8 characters\"\r\n          :error=\"pwdErrors.newPwd\"\r\n          required\r\n        />\r\n        <BaseInput\r\n          v-model=\"pwd.confirm\"\r\n          label=\"Confirm new password\"\r\n          type=\"password\"\r\n          placeholder=\"Repeat new password\"\r\n          :error=\"pwdErrors.confirm\"\r\n          required\r\n        />\r\n        <div class=\"flex justify-end\">\r\n          <BaseButton type=\"submit\" variant=\"primary\" :loading=\"pwdLoading\">Update Password</BaseButton>\r\n        </div>\r\n      </form>\r\n    </div>\r\n\r\n    <!-- Danger zone -->\r\n    <div class=\"rounded-2xl border border-red-500/20 bg-red-500/5 p-6 space-y-4\">\r\n      <h2 class=\"text-base font-semibold text-red-400\">Danger Zone</h2>\r\n      <div class=\"flex items-center justify-between gap-4 flex-wrap\">\r\n        <div>\r\n          <p class=\"text-sm font-medium text-white\">Delete Account</p>\r\n          <p class=\"text-xs text-white/40 mt-0.5\">Permanently delete your account and all your data. This cannot be undone.</p>\r\n        </div>\r\n        <BaseButton variant=\"danger\" @click=\"deleteModalOpen = true\">Delete Account</BaseButton>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Confirm delete modal -->\r\n    <BaseModal v-model:open=\"deleteModalOpen\" title=\"Delete Account\" size=\"sm\">\r\n      <p class=\"text-sm text-white/70 leading-relaxed\">\r\n        Are you absolutely sure? This will permanently delete your account, all your analyses, and all associated data.\r\n        <span class=\"text-red-400 font-semibold\">This action cannot be undone.</span>\r\n      </p>\r\n      <template #footer>\r\n        <BaseButton variant=\"ghost\" @click=\"deleteModalOpen = false\">Cancel</BaseButton>\r\n        <BaseButton variant=\"danger\" :loading=\"deleteLoading\" @click=\"confirmDelete\">\r\n          Yes, delete my account\r\n        </BaseButton>\r\n      </template>\r\n    </BaseModal>\r\n  </div>\r\n</template>\r\n"],"names":["props","__props","emit","__emit","sizes","close","onKeydown","e","onMounted","onUnmounted","_createBlock","_Teleport","_createVNode","_Transition","_createElementBlock","_createElementVNode","_normalizeClass","$slots","_openBlock","_hoisted_1","_hoisted_2","_renderSlot","_ctx","_hoisted_3","authStore","useAuthStore","logout","useAuth","toast","useToast","profile","reactive","profileLoading","ref","profileErrors","pwd","pwdLoading","pwdErrors","deleteModalOpen","deleteLoading","validateProfile","saveProfile","updated","authService","validatePwd","changePassword","confirmDelete","_cache","BaseInput","$event","BaseButton","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","BaseModal"],"mappings":"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"}